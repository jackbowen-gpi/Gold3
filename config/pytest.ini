[pytest]
# Use the repo-root settings shim (settings.py) so tests import behaviour is
# consistent whether pytest runs from the repo root or parent directory.
python_files = tests.py test_*.py *_tests.py
addopts = -q --tb=short

# Explicit Django settings module prevents pytest-django from trying to
# auto-discover the project root which causes import-order races in this
# repository layout.
DJANGO_SETTINGS_MODULE = gchub_db.test_settings
django_find_project = true

# Limit discovery to application test packages to avoid collecting legacy
# backups, the top-level `bin/` scripts, or other non-test modules that
# create duplicate test basenames and import collisions. We used to set
# `testpaths` here, but pytest can warn if the path doesn't exist when
# running from different start locations. We instead rely on pytest's
# default discovery and `collect_ignore` configured in `conftest.py`.
norecursedirs = backups backend .history .venv .git .github
